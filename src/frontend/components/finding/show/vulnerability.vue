<template>
  <FindingShowComponent
    :api="api"
    :finding="finding"
    title="name"
    :subtitle="
      finding.name !== finding.cve && finding.cve !== null ? 'cve' : undefined
    "
    :icon="enums.severity[finding.severity].icon"
    :icon-color="enums.severity[finding.severity].color"
    :icon-tooltip="finding.severity"
    :defectdojo="defectdojo"
    :defectdojo-settings="defectdojoSettings"
    :hacktricks="hacktricks"
    finding-type="vulnerability"
    triage
  >
    <template #append-before>
      <v-btn v-if="finding.trending" icon variant="text">
        <v-icon icon="mdi-fire" color="orange" size="x-large" />
        <v-tooltip activator="parent" text="Trending CVE" />
      </v-btn>
      <v-chip
        v-if="finding.cwe"
        :href="`https://cwe.mitre.org/data/definitions/${finding.cwe.toLowerCase().split('-')[1]}.html`"
        target="_blank"
        :text="finding.cwe.toUpperCase()"
        @click.stop
      />
      <FindingExploitDialog
        v-if="finding.exploit.length > 0"
        :vulnerability="finding"
      />
    </template>
    <template #text>
      <!-- TODO: How can we handle long descriptions? They must be used in a textarea, as sometimes are long with \n and so on, that must be parsed a little bit -->
      {{ finding.description }}
    </template>
  </FindingShowComponent>
</template>

<script setup lang="ts">
defineProps({
  api: Object,
  finding: Object,
  defectdojo: Object,
  defectdojoSettings: Object,
  hacktricks: Object,
});
defineEmits(["reload"]);
const enums = useEnums();
</script>
