<template>
  <Finding
    :api="api"
    :finding="finding"
    title="name"
    :subtitle="
      finding.name !== finding.cve && finding.cve !== null ? 'cve' : undefined
    "
    :icon="enums.severity[finding.severity].icon"
    :icon-color="enums.severity[finding.severity].color"
    :icon-tooltip="finding.severity"
    :defectdojo="defectdojo"
    :defectdojo-settings="defectdojoSettings"
    :hacktricks="hacktricks"
    finding-type="vulnerability"
    triage
  >
    <template #append-before>
      <BaseButton
        v-if="finding.trending"
        icon="mdi-fire"
        icon-color="orange"
        icon-size="x-large"
        tooltip="Trending CVE"
      />
      <v-chip
        v-if="finding.cwe"
        :href="vulnerabilities.cweReference(finding.cwe)"
        target="_blank"
        :text="finding.cwe.toUpperCase()"
        @click.stop
      />
      <FindingExploitDialog
        v-if="finding.exploit.length > 0"
        :vulnerability="finding"
      />
    </template>
    <template #text>
      <!-- TODO: How can we handle long descriptions? They must be used in a textarea, as sometimes are long with \n and so on, that must be parsed a little bit -->
      {{ finding.description }}
    </template>
  </Finding>
</template>

<script setup lang="ts">
defineProps({
  api: Object,
  finding: Object,
  defectdojo: Object,
  defectdojoSettings: Object,
  hacktricks: Object,
});
defineEmits(["reload"]);
const enums = useEnums();
const vulnerabilities = useVulnerabilities();
</script>
